<!DOCTYPE html>
<html lang="en" data-theme="white">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title data-lang-key="prompt_generator_title">Prompt Generator</title>
    <style>
        html[data-theme='white'] #prompt-history-section {
            background-color: #f3f4f6; /* bg-gray-100 */
        }
        html[data-theme='dark'] #prompt-history-section {
            background-color: #374151; /* bg-gray-700 */
        }

        html[data-theme='white'] .prompt-history-item {
            background-color: #ffffff; /* bg-white */
        }
        html[data-theme='dark'] .prompt-history-item {
            background-color: #1f2937; /* bg-gray-800 */
        }

        /* Ensure text colors are correct */
        html[data-theme='white'] .prompt-history-item-prompt {
            color: #4b5563; /* text-gray-600 */
        }
        html[data-theme='dark'] .prompt-history-item-prompt {
            color: #d1d5db; /* text-gray-300 - or #9ca3af if that's preferred */
        }

        /* Ensure placeholder text is correct */
        html[data-theme='white'] #prompt-result-placeholder,
        html[data-theme='white'] #prompt-history-empty-message {
            color: #9ca3af; /* text-gray-400 */
        }
        html[data-theme='dark'] #prompt-result-placeholder,
        html[data-theme='dark'] #prompt-history-empty-message {
            color: #9ca3af; /* text-gray-400 */
        }
        html[data-theme='white'] #prompt-result-container {
            background-color: #f9fafb; /* bg-gray-50 - Very light gray */
        }
        html[data-theme='dark'] #prompt-result-container {
            background-color: #374151; /* bg-gray-700 - Dark gray */
        }
        html[data-theme='white'] .sticky.bottom-4.bg-white.dark\:bg-gray-800 {
            background-color: #ffffff; /* bg-white */
        }
        html[data-theme='dark'] .sticky.bottom-4.bg-white.dark\:bg-gray-800 {
            background-color: #1f2937; /* bg-gray-800 */
        }
              /* --- ONLY ESSENTIAL CUSTOM STYLES --- */
        /* Basic disabled state using Tailwind-like classes (in case Tailwind doesn't cover all cases) */
        textarea:disabled, input:disabled, button:disabled, select:disabled {
            @apply bg-gray-200 dark:bg-gray-600 text-gray-500 dark:text-gray-400 cursor-not-allowed opacity-75;
        }

        /* Notification bar styles */
        #notification-bar {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            background-color: #10b981; /* bg-emerald-500 */
            color: white;
            text-align: center;
            padding: 0.75rem;
            z-index: 1000;
            transform: translateY(-100%);
            transition: transform 0.3s ease-out, opacity 0.3s ease-out;
            opacity: 0;
            box-shadow: 0 2px 4px rgba(0,0,0,0.2);
        }
        #notification-bar.show {
            transform: translateY(0);
            opacity: 1;
        }

        /* Modal styles */
        #app-modal {
            position: fixed;
            z-index: 1050;
            left: 0; top: 0;
            width: 100%; height: 100%;
            background-color: rgba(0,0,0,0.5);
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 20px;
        }
        #app-modal-content {
            background-color: #fefefe; /* bg-white */
            color: #333; /* Ensure text is visible */
            margin: auto;
            padding: 20px;
            border: 1px solid #888;
            border-radius: 0.5rem; /* rounded-lg */
            width: 90%;
            max-width: 500px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            position: relative;
        }
        #modal-close-button {
            color: #aaa;
            float: right;
            font-size: 28px;
            font-weight: bold;
            cursor: pointer;
            position: absolute;
            top: 10px;
            right: 15px;
        }
        #modal-close-button:hover,
        #modal-close-button:focus {
            color: #000;
            text-decoration: none;
        }

        /* Utility classes */
        .hidden { display: none !important; }
        body.modal-open { overflow: hidden; }

        /* Force LTR for specific inputs */
        #edit-instruction-input, #generated-prompt-output, #prompt-result-textarea {
            direction: ltr;
        }

        /* Ensure main areas can scroll */
        main, #prompt-result-container {
            overflow: visible;
        }

        /* Specific styles for display-uploaded-image */
        html[data-theme='white'] #display-prompt-uploaded-image {
            background-color: #f9fafb; /* bg-gray-50 */
            border-color: #d1d5db; /* border-gray-300 */
        }
        html[data-theme='dark'] #display-prompt-uploaded-image {
            background-color: #1f2937; /* bg-gray-800/50 */
            border-color: #374151; /* border-gray-700 */
        }

                /* Force LTR for the prompt input */
        #edit-instruction-input{
            direction: ltr;
        }

        /* Prompt History Item Styles - Use Tailwind classes directly in JS-generated HTML */
        /* .prompt-history-item, .prompt-history-item-prompt, .prompt-history-item-copy-btn styles are now applied via JS using classList.add() */

        /* --- END ESSENTIAL CUSTOM STYLES --- */
    </style>
    <link rel="stylesheet" type="text/css" href="./css/prompt-generator.css">
</head>
<body class="font-inter transition-colors duration-300 flex flex-col min-h-screen"> <!-- Ensure full height -->

    <!-- *** INTEGRATED HEADER (Copied directly from image-ai.html) *** -->
    <header class="flex-shrink-0 shadow-md p-4 flex flex-col transition-colors duration-300 h-24">
        <div class="flex justify-between items-center w-full mb-2">
            <h1 class="text-3xl font-bold text-[#3c32c8] flex items-center" dir="ltr">
                <img src="./sources/artboard-19-copy-4.webp" alt="Paltech Hub Logo" class="h-10 inline-block mr-2 align-middle" onerror="this.onerror=null;this.src='https://placehold.co/100x32/cccccc/333333?text=Paltech+Logo';"> AI
            </h1>
            <div id="right-controls" class="flex items-center gap-4" dir="ltr">
                <button id="back-button" class="p-2 rounded-full bg-gray-200 dark:bg-gray-700 text-gray-800 dark:text-gray-200 hover:bg-gray-300 dark:hover:bg-gray-600 transition-colors duration-300">
                    <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 19l-7-7m0 0l7-7m-7 7h18"></path></svg>
                </button>
                <button id="theme-toggle" class="p-2 rounded-full bg-gray-200 dark:bg-gray-700 text-gray-800 dark:text-gray-200 hover:bg-gray-300 dark:hover:bg-gray-600 transition-colors duration-300">
                    <span id="theme-icon" class="text-xl">ðŸ’¡</span>
                </button>
                <select id="language-select" class="p-2 rounded-md bg-gray-200 dark:bg-gray-700 text-gray-800 dark:text-gray-200 border border-gray-300 dark:border-gray-600">
                    <option value="en" data-lang-key="lang_english">English</option>
                    <option value="ar" data-lang-key="lang_arabic">Ø§Ù„Ø¹Ø±Ø¨ÙŠØ©</option>
                </select>
            </div>
        </div>

        <div class="w-full bg-gray-300 dark:bg-gray-700 h-1">
            <div id="main-progress" class="bg-[#3c32c8] h-1 transition-all duration-300" style="width: 0%"></div>
        </div>
        <div id="current-node-status" class="text-center text-xs text-gray-600 dark:text-gray-400 py-1"></div>
    </header>
    <!-- *** END INTEGRATED HEADER *** -->

    <!-- Notification Bar -->
    <div id="notification-bar" class="hidden"></div>

    <!-- Modal -->
    <div id="app-modal" class="hidden">
        <div id="app-modal-content">
            <span id="modal-close-button">&times;</span>
            <h2 class="text-xl font-bold mb-4" data-lang-key="modal_notification_title">Notification</h2>
            <p id="modal-message"></p>
        </div>
    </div>

    <!-- Main Content Area (Grid Layout like image-ai.html) -->
    <div id="prompt-generator-main-content" class="flex flex-col md:flex-row w-full max-w-7xl mx-auto p-4 sm:p-6">
        <aside class="w-full md:w-1/3 p-6 transition-colors duration-300 flex flex-col">
                <div class="space-y-6 flex-grow pb-24">

                    <details class="space-y-4" open>
                        <summary class="text-lg font-semibold cursor-pointer list-none text-gray-900 dark:text-white" data-lang-key="preset_selection_title">Preset Selection</summary>
                        <div class="pl-4 pt-4 border-l-2 border-gray-300 dark:border-gray-700">
                            <label for="preset-select" class="block mb-2 text-sm font-medium text-gray-900 dark:text-white" data-lang-key="select_preset_label">Choose a Preset:</label>
                            <select id="preset-select" class="w-full rounded-md shadow-sm p-2 text-sm bg-gray-50 border border-gray-300 focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-blue-500 dark:focus:border-blue-500">
                                <option value="Kid Clothes" data-lang-key="preset_kid_clothes">Kid Clothes</option>
                                <option value="Womenâ€™s Clothes" data-lang-key="preset_womens_clothes">Womenâ€™s Clothes</option>
                                <option value="Beauty Product Use" data-lang-key="preset_beauty_product_use" selected>Beauty Product Use</option>
                                <option value="Beauty Product Display" data-lang-key="preset_beauty_product_display">Beauty Product Display</option>
                            </select>
                        </div>
                    </details>

                    <details class="space-y-4" open>
                        <summary class="text-lg font-semibold cursor-pointer list-none text-gray-900 dark:text-white" data-lang-key="edit_instruction_title">Edit Instruction</summary>
                        <div class="pl-4 pt-4 border-l-2 border-gray-300 dark:border-gray-700">
                            <textarea id="edit-instruction-input" rows="7" class="w-full rounded-md shadow-sm p-2 text-sm bg-gray-50 border border-gray-300 focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-blue-500 dark:focus:border-blue-500" data-lang-key="edit_instruction_placeholder" placeholder="Describe how you want to modify the image..." dir="ltr"></textarea>
                        </div>
                    </details>

                    <details class="space-y-4" open>
                        <summary class="text-lg font-semibold cursor-pointer list-none text-gray-900 dark:text-white" data-lang-key="image_upload_title">Image To Upload</summary>
                        <div class="pl-4 pt-4 border-l-2 border-gray-300 dark:border-gray-700">
                            <input type="file" id="image-input" accept="image/*" class="hidden"> 
                            <label for="image-input" class="block w-full text-center cursor-pointer font-semibold py-2 px-4 rounded-md transition-colors duration-300" data-lang-key="select_image_button">Select Image</label>
                            <div class="relative">
                                <button 
                                    type="button" 
                                    id="remove-image" 
                                    class="absolute -top-2 -right-2 bg-red-500 text-white rounded-full w-6 h-6 flex items-center justify-center hover:bg-red-600 active:bg-red-700 transition duration-200 focus:outline-none 
                                    focus:ring-2 focus:ring-red-400 cursor-pointer ease-in-out "
                                    title="Remove image"
                                >
                                    <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
                                    </svg>
                                </button>
                                <div id="display-prompt-uploaded-image" class="mt-4 w-full h-48 rounded-md border border-gray-300 dark:border-gray-700 bg-gray-200 dark:bg-gray-700 flex items-center justify-center">
                                    <div id="image-upload-spinner" class="absolute inset-0 flex items-center justify-center bg-white bg-opacity-70 dark:bg-gray-900 dark:bg-opacity-70 hidden z-10">
                                        <div class="w-8 h-8 border-4 border-blue-500 border-t-transparent rounded-full animate-spin"></div>
                                    </div>
                                    <span class="text-gray-500 dark:text-gray-400" data-lang-key="image_preview_placeholder">Image Preview</span>
                                </div>
                            </div>
                        </div>
                    </details>

                    <div class="sticky bottom-4 bg-white dark:bg-gray-800 pb-4 border-t border-gray-200 dark:border-gray-700">
                        <div class="flex flex-col gap-2">
                            <button id="generate-prompt" class="w-full bg-[#3c32c8] hover:bg-[#2a23a0] cursor-pointer text-white font-bold py-3 px-6 rounded-lg shadow transition duration-300 ease-in-out transform hover:scale-[1.02] flex items-center justify-center gap-2"> 
                                <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"> 
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 10V3L4 14h7v7l9-11h-7z"></path>
                                </svg>
                                <span data-lang-key="generate_prompt_button">Generate Prompt</span> 
                                <span id="prompt-loading-spinner" class="hidden flex items-center justify-center">
                                    <svg class="animate-spin h-5 w-5 text-white" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24">
                                        <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle>
                                        <path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path>
                                    </svg>
                                </span>
                            </button>
                            <button id="interrupt-prompt" class="w-full text-white bg-red-600 hover:bg-red-700 focus:ring-4 focus:outline-none focus:ring-red-300 font-medium rounded-lg text-sm px-5 py-2.5 text-center dark:bg-red-600 dark:hover:bg-red-700 dark:focus:ring-red-800 hidden flex items-center justify-center">
                                <svg class="w-5 h-5 mr-1" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path></svg>
                                <span data-lang-key="interrupt_button">Interrupt</span>
                            </button>
                        </div>
                    </div>
                </div>
        </aside>

        <main class="w-full md:w-2/3 p-6 pt-0 md:pt-6 flex flex-col">
        <!-- <main class="space-y-6 flex-grow md:w-2/3 flex flex-col transition-colors duration-300 p-8"> -->
            <div class="space-y-6 flex flex-col min-h-screen flex-grow">
                <h2 class="text-2xl font-bold text-gray-900 dark:text-white mb-4">
                    <span data-lang-key="generated_prompt_title">Generated Prompt</span>
                </h2>

                
                <div id="prompt-result-container" class="basis-[70%] grow bg-gray-100 dark:bg-gray-700 rounded-lg shadow-md p-4 h-full flex flex-col">
                    <div id="prompt-result-placeholder" class="text-gray-500 dark:text-gray-400 italic flex-grow flex items-center justify-center text-center">
                        <p data-lang-key="prompt_result_placeholder">Generated prompt will appear here...</p>
                    </div>
                    <div id="prompt-result-display" class="flex-grow overflow-auto hidden mb-4">
                        <label for="generated-prompt-output" class="block mb-2 text-sm font-medium text-gray-900 dark:text-white" data-lang-key="generated_prompt_title">Generated Prompt</label>
                        <div class="relative"> 
                            <textarea id="generated-prompt-output" rows="5" class="w-full p-3 text-sm text-gray-900 bg-white border border-gray-300 rounded-lg shadow-sm focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-800 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-blue-500 dark:focus:border-blue-500 resize-none h-32" readonly></textarea>
                        </div>
                    </div>

                    <div class="mt-2">
                        <label for="prompt-result-textarea" class="block mb-2 text-sm font-medium text-gray-900 dark:text-white" data-lang-key="prompt_output_label">Prompt Output (Editable):</label>
                        <textarea id="prompt-result-textarea" rows="3" class="w-full rounded-md shadow-sm p-2 text-sm bg-gray-50 border border-gray-300 focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-blue-500 dark:focus:border-blue-500 resize-y"></textarea>
                        <div class="flex flex-wrap gap-2 mt-2">
                            <button id="copy-prompt-textarea-button" class="
                            px-4
                            py-2
                            bg-[#3c32c8]
                            hover:bg-[#2a23a0]
                            text-white
                            font-medium
                            rounded-lg
                            shadow
                            transition
                            duration-300
                            ease-in-out
                            cursor-pointer
                            flex
                            items-center
                            text-sm">
                                <svg class="w-4 h-4 mr-1" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"></path>
                                </svg>
                                <span data-lang-key="copy_to_clipboard">Copy</span>
                            </button>
                            <a href="image-ai.html" id="use-prompt-link" class="px-3 py-1.5 cursor-pointer text-sm font-medium text-center text-white bg-green-600 hover:bg-green-700 focus:ring-4 focus:outline-none focus:ring-green-300 dark:bg-green-600 dark:hover:bg-green-700 dark:focus:ring-green-800 rounded-md transition-colors duration-300 inline-flex items-center">
                                <svg class="w-4 h-4 mr-1" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M14 5l7 7m0 0l-7 7m7-7H3"></path>
                                </svg>
                                <span data-lang-key="use_prompt_in_image_ai">Use in Image AI</span>
                            </a>
                        </div>
                    </div>
                </div> 

                <div id="prompt-history-section" class="basis-[30%] mt-6 p-4 pb-6 bg-gray-100 dark:bg-gray-700 rounded-lg shadow"> 
                     <h3 class="text-xl font-semibold text-gray-900 dark:text-white mb-3 flex items-center justify-between">
                        <span data-lang-key="prompt_history_title">Prompt History</span>
                        <button id="clear-prompt-history-button" class="px-4 py-2 text-sm cursor-pointer bg-red-500 hover:bg-red-700 text-white rounded-md transition-colors duration-300">
                            <span data-lang-key="clear_prompt_history_button">Clear History</span>
                        </button>
                    </h3>
                    <div id="prompt-history-container" class="space-y-2 overflow-y-auto max-h-60 scroll-smooth">
                        <p id="prompt-history-empty-message" class="text-gray-500 dark:text-gray-400 text-sm text-center" data-lang-key="prompt_history_empty_message">No prompt history yet.</p>
                    </div>
                </div>

            </div>
        </main>
    </div> 

    <!-- *** INTEGRATED FOOTER (Copied directly from image-ai.html) *** -->
    <footer class="flex-shrink-0 p-4 text-center shadow-md text-sm transition-colors duration-300">
        <p data-lang-key="footer_text">Â© 2024 Paltech Hub AI v0.1. All rights reserved.</p>
    </footer>
    <!-- *** END INTEGRATED FOOTER *** -->

</body>
</html>